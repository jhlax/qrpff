sub r{ord pack"B8",unpack"b8",chr shift}sub c{($a, $b)=@_;@a=map{ord}split//,$a;
@b=map{ord}split//,$b;$c[$_]=$b[$_]^$a[84+$_]for(0..4);$d=(($c[4]<<17)|($c[3]<<9
)|($c[2]<<1))+8-($c[2]&7);$d=(r($d&255)<<17)|(r(($d>>8)&255)<<9)|(r(($d>>16)&255
)<<1)|($d>>24);$e=(r($c[0])<<9)|256|(r($c[1]));$h=0;for(128..2047){$f=($d>>12)^(
$d>>4)^($d>>3)^$d;$g=(($e>>14)&7)^$e;$g^=($g<<3)^($g<<6);$f&=255;$g&=255;$e=($e
>>8)^($g<<9);$d=($d>>8)^($f<<17);$h+=$f+(~$g&255);$a[$_]=$t[$a[$_]]^($h&255);$h
>>=8}join'',map{chr}@a}1;
